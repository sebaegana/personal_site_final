---
header-includes:
  - \usepackage[spanish]{babel}
  - \usepackage{svg}
  - \usepackage[normalem]{ulem}
  - \usepackage{attachfile}
title: |
  ![](logo_fen.jpg){width=2in}  
  ICO 187 ANÁLISIS DE DATOS
author: "Clase 29: Análisis de datos con R"
year: 2021
prof: "Sebastián Egaña"
# due: "Jueves 11 de Marzo"
# submit: "engin604assignments@gmail.com"
# page: "5 páginas"
# bibliography: "latex/references.bib"
# biblio-style: "acm"
link-citations: yes
citecolor: blue
urlcolor: blue
linkcolor: blue
geometry: margin=0.75in
fontsize: 10pt
output: 
  bookdown::pdf_document2:
    toc: no
    highlight: "default"
    number_sections: yes
    fig_caption: yes
    dev: cairo_pdf
    latex_engine: pdflatex
    template: "Latex/template.tex"
always_allow_html: true
nocite: '@*'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tinytex.verbose = TRUE)

library(readxl)
library(datamodelr)
library(tidyverse)
library("factoextra")
library(FactoMineR)
library(cluster)
library(gridExtra)

data <- read_excel("clase_27.xlsx")

data <- mutate(data, fecha_nacimiento_2 = as.POSIXct(fecha_nacimiento, format = "%d-%m-%Y"))

```

# Transform

Recordemos como generamos la edad en su momento:

```{r, eval=FALSE}
data <- mutate(data, fecha_nacimiento_2 = as.POSIXct(fecha_nacimiento, format = "%d-%m-%Y"))
```

Lo que utilizando el operador pipe

```{r, eval=FALSE}
library(dply)

data <- data %>% 
  mutate(fecha_nacimiento_2 = as.POSIXct(fecha_nacimiento, format = "%d-%m-%Y"))

```

Veamos como generar una variable relacionada con la edad:

```{r}
data <- data %>% 
  mutate(hoy = as.POSIXct("2021-04-25", format = "%Y-%m-%d"),
         edad = (hoy - fecha_nacimiento_2)/365)
```

# Visualize

Crearemos un gráfico simple, utilizando la librería ggplot2^[Recordar instalar y cargar la librería].

Revisemos el Cheatsheet asociado:

\href{https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf}{Enlace acá}

En relación a esto, un gráfico utilizando ggplot2 se construye a través de los siguientes elementos:

1. Un set de datos.
2. Un sistema de coordenadas. 
3. Figuras geométricas (geoms) o representaciones visuales de los datos. 

Para cambiar la forma en que se muestran los datos se pueden editar las figuras geométricas (geoms), cambiando color, tamaño y la ubicación de los puntos en x y/o en y. 

Inclusive se plantea una plantilla para esto:

```{r, eval=FALSE}
ggplot (data = <DATA> ) +
 <GEOM_FUNCTION> (mapping = aes( <MAPPINGS> ),
 stat = <STAT> , position = <POSITION> ) +
 <COORDINATE_FUNCTION> +
 <FACET_FUNCTION> +
 <SCALE_FUNCTION> +
 <THEME_FUNCTION>
```

En donde las dos primeras líneas son necesarias. 

Apliquemos esto a los datos importados. Referencia relevante para esta parte \href{https://www.datanalytics.com/libro_r/elementos-de-un-grafico-en-ggplot2.html}{Enlace acá}

1. Asignamos el set de datos:

```{r}
p <- ggplot(data)

p
```

2. Ahora declaramos el sistema de coordenadas:

```{r}
p <- ggplot(data) + aes(x = sexo, y = fibe)

p
```

- Cabe mencionar, que cada elemento que se agrega dentro de un gráfico creado utilizando con ggplot, se realiza utilizando el signo "+" para esto. 

3. Declaremos ahora el tipo de figura que graficaremos:

```{r}
p <- ggplot(data) + aes(x = sexo) + geom_bar()

p
```

Profundizemos en esto en base a la siguiente página:

\href{https://ggplot2.tidyverse.org/reference/geom_bar.html}{Enlace acá}

Podemos voltear el gráfico, y agregar diferenciación en base a otra variable:

```{r}
p <- ggplot(data) + aes(y = sexo) + geom_bar(aes(fill = afectacion))

p
```

Podríamos graficar de manera separada cada columna, en base a esta página \href{http://www.sthda.com/english/wiki/ggplot2-barplots-quick-start-guide-r-software-and-data-visualization}{Enlace acá}:

```{r}
p <- ggplot(data) + aes(y = sexo, fill = afectacion) + geom_bar(position=position_dodge())

p

```



# Fechas Relevantes

\begin{center}
\begin{tabular}{|c|l|c|c|}
	\hline
	Unidad & Evaluación & Ponderación & Fecha \\
	\hline
	Unidad I & \sout{Evaluación diagnóstica} & & 25/03/2021 \\
	\hline
	& \sout{Evaluación Individual Participación} & (5\%) & 05/04/2021 \\
	\hline
	& \sout{Evaluación Grupal} & (15\%) & 27/04/2021 - 04/05/2021 \\
	\hline
	& \sout{Evaluación Individual - Sumativa I} & (30\%) & 11/05/2021 \\
	\hline
	Unidad II & \sout{Evaluación Grupal} & (15\%) & 20/06/2021 \\
	\hline
	& \sout{Evaluación Grupal - Sumativa II} & (15\%) & 04/07/2021 \\
	\hline
	Unidad III & Evaluación Formativa & & - \\
	\hline
	& Evaluación Grupal Sesión I- Sumativa III & (20\%) & 08/07/2021 \\
	\hline
	& Evaluación grupal Sesión II- Sumativa III & (20\%) & 13/07/2021 \\
	\hline
\end{tabular}
\end{center}

